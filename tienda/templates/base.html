{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Papeler√≠a Ganbaru{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="{% static 'tienda/css/styles.css' %}" rel="stylesheet">

  <style>
    .messages-container {
      position: relative;
      max-width: 960px;
      margin: 1.5rem auto 0;
      z-index: 20;
    }

    .msg {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.75rem;
      padding: 0.9rem 1.2rem;
      margin-bottom: 0.7rem;
      border-radius: 18px;
      font-size: 0.95rem;
      font-weight: 600;
      box-shadow: 0 10px 25px rgba(255, 135, 170, 0.25);
      backdrop-filter: blur(10px);
      background: linear-gradient(135deg, rgba(255, 239, 245, 0.95), rgba(255, 215, 234, 0.9));
      border: 1px solid rgba(255, 166, 201, 0.7);
      color: #6f3045;
      animation: msgFadeIn 0.35s ease-out;
    }

    .msg-left {
      display: flex;
      align-items: center;
      gap: 0.45rem;
      flex: 1;
    }

    .msg-icon {
      width: 30px;
      height: 30px;
      border-radius: 999px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.15rem;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.04);
    }

    .msg-close {
      border: none;
      background: rgba(255, 255, 255, 0.6);
      border-radius: 999px;
      width: 26px;
      height: 26px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      cursor: pointer;
      color: #a0465f;
      transition: background 0.15s ease, transform 0.15s ease;
    }

    .msg-close:hover {
      background: rgba(255, 255, 255, 0.9);
      transform: translateY(-1px);
    }

    /* Variantes por tipo, todas en la gama rosada / pastel */
    .msg-success {
      background: linear-gradient(135deg, #f0fff5, #e0ffe9);
      border-color: #86d9a4;
      color: #2f7245;
      box-shadow: 0 10px 25px rgba(134, 217, 164, 0.3);
    }

    .msg-error {
      background: linear-gradient(135deg, #ffe5ec, #ffd0dd);
      border-color: #ff8aa5;
      color: #8d2137;
      box-shadow: 0 10px 25px rgba(255, 138, 165, 0.35);
    }

    .msg-warning {
      background: linear-gradient(135deg, #fff6e0, #ffe9b8);
      border-color: #ffd374;
      color: #8a6a1b;
      box-shadow: 0 10px 25px rgba(255, 211, 116, 0.3);
    }

    .msg-info {
      background: linear-gradient(135deg, #e7f3ff, #d8e9ff);
      border-color: #7eb4ff;
      color: #275383;
      box-shadow: 0 10px 25px rgba(126, 180, 255, 0.3);
    }

    @keyframes msgFadeIn {
      from { opacity: 0; transform: translateY(-6px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* En pantallas muy peque√±as, que ocupen casi todo el ancho */
    @media (max-width: 640px) {
      .messages-container {
        margin-inline: 1rem;
      }
      .msg {
        padding-inline: 0.9rem;
      }
    }
  </style>
</head>

<body class="bg">
  <header class="site-header glass">
    <div class="wrap header-inner">
      <a class="brand" href="{% url 'tienda:inicio' %}">
        <img src="{% static 'tienda/img/ganbaru.jpg' %}" alt="Papeler√≠a Ganbaru" class="logo">
        <span class="brand-main">GANBARU</span>
        <span class="brand-sub">√∫tiles ‚Ä¢ oficina ‚Ä¢ escuela</span>
      </a>

      <nav class="main-nav">
        <a href="{% url 'tienda:carrito_ver' %}" class="btn btn-pill btn-secondary">Carrito</a>

        {% if user.is_authenticated %}
          <a href="{% url 'tienda:perfil' %}" class="btn btn-pill btn-outline">üë§ Mi perfil</a>

          {% if user.is_staff %}
            <a class="btn btn-secondary btn-pill" href="{% url 'tienda:panel_home' %}">Panel</a>
            <a href="{% url 'admin:index' %}" class="btn btn-pill btn-ghost">Admin</a>
          {% endif %}

          <form action="{% url 'tienda:logout' %}" method="post" class="inline-form">
            {% csrf_token %}
            <button type="submit" class="btn btn-pill btn-danger">Salir</button>
          </form>
        {% else %}
          <a href="{% url 'tienda:login' %}" class="btn btn-pill btn-outline">Iniciar sesi√≥n</a>
          <a href="{% url 'tienda:registro' %}" class="btn btn-pill btn-primary">Registrarse</a>
        {% endif %}
      </nav>
    </div>
  </header>

  {% if messages %}
    <div class="messages-container">
      {% for message in messages %}
        <div class="msg msg-{{ message.tags|default:'info' }}">
          <div class="msg-left">
            <span class="msg-icon">
              {% if message.tags == "success" %}‚úîÔ∏è{% endif %}
              {% if message.tags == "error" %}‚ùå{% endif %}
              {% if message.tags == "warning" %}‚ö†Ô∏è{% endif %}
              {% if message.tags == "info" or not message.tags %}üå∏{% endif %}
            </span>
            <span class="msg-text">{{ message }}</span>
          </div>

          <button class="msg-close" onclick="this.closest('.msg').remove()">‚úï</button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <main class="wrap">
    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer glass">
    <div class="wrap footer-inner">
      <p>¬© {{ now|date:"Y" }} Papeler√≠a Ganbaru</p>
      <p class="fine">Santiago de Chile</p>
    </div>
  </footer>
</body>
</html>
